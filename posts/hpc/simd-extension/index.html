<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>SIMD Extension - </title><meta name=author content="ghy"><meta name=author-link content="https://github.com/gaohongy"><meta name=description content="Categories Hot to check the SIME extension support of cpu ? 1 cat /proc/cpuinfo For x86 instruction set MMX SSE (Streaming SIMD extensions) AVX (Advanced Vector Extensions) AVX2 AVX512 etc For ARM instruction set NEON AVX Usage of SIMD intrinsic header file If you don&rsquo;t know which header file to include, please find the function you want to call in Intel Intrinsics Guide，wh"><meta name=keywords content='Hugo,FixIt'><meta itemprop=name content="SIMD Extension"><meta itemprop=description content="Categories Hot to check the SIME extension support of cpu ? 1 cat /proc/cpuinfo For x86 instruction set MMX SSE (Streaming SIMD extensions) AVX (Advanced Vector Extensions) AVX2 AVX512 etc For ARM instruction set NEON AVX Usage of SIMD intrinsic header file If you don’t know which header file to include, please find the function you want to call in Intel Intrinsics Guide，wh"><meta itemprop=datePublished content="2024-06-03T16:09:29+08:00"><meta itemprop=dateModified content="2024-06-03T23:45:27+08:00"><meta itemprop=wordCount content="1689"><meta itemprop=keywords content="HPC"><meta property="og:url" content="https://gaohongy.github.io/blog/posts/hpc/simd-extension/"><meta property="og:title" content="SIMD Extension"><meta property="og:description" content="Categories Hot to check the SIME extension support of cpu ? 1 cat /proc/cpuinfo For x86 instruction set MMX SSE (Streaming SIMD extensions) AVX (Advanced Vector Extensions) AVX2 AVX512 etc For ARM instruction set NEON AVX Usage of SIMD intrinsic header file If you don’t know which header file to include, please find the function you want to call in Intel Intrinsics Guide，wh"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-06-03T16:09:29+08:00"><meta property="article:modified_time" content="2024-06-03T23:45:27+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="SIMD Extension"><meta name=twitter:description content="Categories Hot to check the SIME extension support of cpu ? 1 cat /proc/cpuinfo For x86 instruction set MMX SSE (Streaming SIMD extensions) AVX (Advanced Vector Extensions) AVX2 AVX512 etc For ARM instruction set NEON AVX Usage of SIMD intrinsic header file If you don’t know which header file to include, please find the function you want to call in Intel Intrinsics Guide，wh"><meta name=application-name content="FixIt"><meta name=apple-mobile-web-app-title content="FixIt"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://gaohongy.github.io/blog/posts/hpc/simd-extension/><link rel=prev href=https://gaohongy.github.io/blog/posts/hpc/openmp/><link rel=stylesheet href=/blog/css/style.min.css><link rel=stylesheet href=/blog/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/blog/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"SIMD Extension","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/gaohongy.github.io\/blog\/posts\/hpc\/simd-extension\/"},"genre":"posts","wordcount":1689,"url":"https:\/\/gaohongy.github.io\/blog\/posts\/hpc\/simd-extension\/","datePublished":"2024-06-03T16:09:29+08:00","dateModified":"2024-06-03T23:45:27+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"ghy"},"description":""}</script></head><body data-header-desktop=sticky data-header-mobile=auto><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper><div class=header-title><a href=/blog/ title><img loading=lazy src=https://cdn.jsdelivr.net/gh/G-ghy/cloudImages@master/202301210616317.png data-title=https://cdn.jsdelivr.net/gh/G-ghy/cloudImages@master/202301210616317.png data-alt=https://cdn.jsdelivr.net/gh/G-ghy/cloudImages@master/202301210616317.png class=logo style="background:url(/blog/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text></span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/blog/posts/>文章</a></li><li class=menu-item><a class=menu-link href=/blog/categories/>分类</a></li><li class=menu-item><a class=menu-link href=/blog/tags/>标签</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容…… id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/blog/ title><img loading=lazy src=https://cdn.jsdelivr.net/gh/G-ghy/cloudImages@master/202301210616317.png data-title=https://cdn.jsdelivr.net/gh/G-ghy/cloudImages@master/202301210616317.png data-alt=https://cdn.jsdelivr.net/gh/G-ghy/cloudImages@master/202301210616317.png class=logo style="background:url(/blog/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text></span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容…… id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/blog/posts/>文章</a></li><li class=menu-item><a class=menu-link href=/blog/categories/>分类</a></li><li class=menu-item><a class=menu-link href=/blog/tags/>标签</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><nav aria-label=breadcrumb class=breadcrumb-container><ol class=breadcrumb><li class=breadcrumb-item><a href=/blog/ title>主页</a></li><li class=breadcrumb-item><a href=/blog/posts/ title=Posts>Posts</a></li><li class="breadcrumb-item active" aria-current=page>SIMD Extension</li></ol></nav><main class=container><aside class=toc id=toc-auto><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class="toc-content always-active" id=toc-content-auto></div></aside><aside class=aside-custom></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>SIMD Extension</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://github.com/gaohongy title=作者 target=_blank rel="external nofollow noopener noreferrer author" class=author><img loading=lazy src=https://cdn.jsdelivr.net/gh/G-ghy/cloudImages@master/202205161528792.jpg data-title=ghy data-alt=ghy class=avatar style="background:url(/blog/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'>&nbsp;ghy</a></span>
<span class=post-category>收录于 <a href=/blog/categories/hpc/><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> HPC</a></span></div><div class=post-meta-line><span title="发布于 2024-06-03 16:09:29"><i class="fa-regular fa-calendar-alt fa-fw me-1" aria-hidden=true></i><time datetime=2024-06-03>2024-06-03</time></span>&nbsp;<span title="更新于 2024-06-03 23:45:27"><i class="fa-regular fa-edit fa-fw me-1" aria-hidden=true></i><time datetime=2024-06-03>2024-06-03</time></span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#categories>Categories</a></li><li><a href=#usage-of-simd-intrinsic>Usage of SIMD intrinsic</a><ul><li><a href=#header-file>header file</a></li><li><a href=#compile-option>compile option</a></li></ul></li><li><a href=#data-process>Data process</a><ul><li><a href=#vector-addition>Vector Addition</a></li><li><a href=#horizontal-addition>Horizontal Addition</a></li><li><a href=#compare>Compare</a></li><li><a href=#set>set</a></li></ul></li></ul></nav></div></div><div class=content id=content data-end-flag=EOF><h2 id=categories>Categories</h2><p><strong>Hot to check the SIME extension support of cpu ?</strong></p><div class=highlight id=id-1><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /proc/cpuinfo</span></span></code></pre></td></tr></table></div></div><ol><li>For x86 instruction set</li></ol><ul><li>MMX</li><li>SSE (Streaming SIMD extensions)</li><li>AVX (Advanced Vector Extensions)</li><li>AVX2</li><li>AVX512</li></ul><p>etc</p><ol start=2><li>For ARM instruction set</li></ol><ul><li>NEON</li><li>AVX</li></ul><h2 id=usage-of-simd-intrinsic>Usage of SIMD intrinsic</h2><h3 id=header-file>header file</h3><p>If you don&rsquo;t know which header file to include, please find the function you want to call in <a href=https://www.intel.com/content/www/us/en/docs/intrinsics-guide/index.html# target=_blank rel="external nofollow noopener noreferrer">Intel Intrinsics Guide</a>，when you launch the detail of function, you will find the header file you need to include.</p><div class=highlight id=id-2><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=o>&lt;</span><span class=n>mmintrin</span><span class=p>.</span><span class=n>h</span><span class=o>&gt;</span>  <span class=n>MMX</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>xmmintrin</span><span class=p>.</span><span class=n>h</span><span class=o>&gt;</span> <span class=n>SSE</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>emmintrin</span><span class=p>.</span><span class=n>h</span><span class=o>&gt;</span> <span class=n>SSE2</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>pmmintrin</span><span class=p>.</span><span class=n>h</span><span class=o>&gt;</span> <span class=n>SSE3</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>tmmintrin</span><span class=p>.</span><span class=n>h</span><span class=o>&gt;</span> <span class=n>SSSE3</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>smmintrin</span><span class=p>.</span><span class=n>h</span><span class=o>&gt;</span> <span class=n>SSE4</span><span class=mf>.1</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>nmmintrin</span><span class=p>.</span><span class=n>h</span><span class=o>&gt;</span> <span class=n>SSE4</span><span class=mf>.2</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>ammintrin</span><span class=p>.</span><span class=n>h</span><span class=o>&gt;</span> <span class=n>SSE4A</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>wmmintrin</span><span class=p>.</span><span class=n>h</span><span class=o>&gt;</span> <span class=n>AES</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>immintrin</span><span class=p>.</span><span class=n>h</span><span class=o>&gt;</span> <span class=n>AVX</span><span class=p>,</span> <span class=n>AVX2</span><span class=p>,</span> <span class=n>FMA</span></span></span></code></pre></td></tr></table></div></div><p>But there is a saying that</p><blockquote><p>These days you should normally just include <code>&lt;immintrin.h></code>. It includes everything. <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p></blockquote><p>After actual testing(use SSE2 but include the &lt;immintrin.h>), this statement has no problem.</p><h3 id=compile-option>compile option</h3><div class=highlight id=id-3><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>-mmmx
</span></span><span class=line><span class=cl>-msse
</span></span><span class=line><span class=cl>-msse2
</span></span><span class=line><span class=cl>-msse3
</span></span><span class=line><span class=cl>-mssse3
</span></span><span class=line><span class=cl>-msse4.1
</span></span><span class=line><span class=cl>-msse4.2
</span></span><span class=line><span class=cl>-msse4
</span></span><span class=line><span class=cl>-mavx
</span></span><span class=line><span class=cl>-mavx2</span></span></code></pre></td></tr></table></div></div><p>You can search more compile options in <a href="https://gcc.gnu.org/onlinedocs/gcc-13.2.0/gcc/Option-Summary.html#:~:text=lazy%20%20%2DXbind%2Dnow-,x86%20Options,-%2Dmtune%3Dcpu" target=_blank rel="external nofollow noopener noreferrer">gnu Option Summary | x86 Options</a>.</p><h2 id=data-process>Data process</h2><h3 id=vector-addition>Vector Addition</h3><div class=highlight id=id-4><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=c1>// compile with -mavx
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;immintrin.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;iostream&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>double</span> <span class=n>a</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=mf>1.0</span> <span class=p>,</span> <span class=mf>2.0</span><span class=p>,</span> <span class=mf>3.0</span><span class=p>,</span> <span class=mf>4.0</span><span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=kt>double</span> <span class=n>b</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=mf>4.0</span><span class=p>,</span> <span class=mf>3.0</span><span class=p>,</span> <span class=mf>2.0</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=kt>double</span> <span class=n>dst</span><span class=p>[</span><span class=mi>4</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>__m256d</span> <span class=n>va</span> <span class=o>=</span> <span class=n>_mm256_loadu_pd</span><span class=p>(</span><span class=n>a</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>__m256d</span> <span class=n>vb</span> <span class=o>=</span> <span class=n>_mm256_loadu_pd</span><span class=p>(</span><span class=n>b</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>__m256d</span> <span class=n>vdst</span> <span class=o>=</span> <span class=n>_mm256_add_pd</span><span class=p>(</span><span class=n>va</span><span class=p>,</span> <span class=n>vb</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>_mm256_storeu_pd</span><span class=p>(</span><span class=n>dst</span><span class=p>,</span> <span class=n>vdst</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>std</span><span class=o>::</span><span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>dst</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=sc>&#39; &#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>std</span><span class=o>::</span><span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><h3 id=horizontal-addition>Horizontal Addition</h3><p>The effect of this function is confusing, because it store the two array&rsquo;s adjacent data sum crossly. I can not image the usage in realistic scenes.</p><div class=highlight id=id-5><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;immintrin.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;iostream&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>double</span> <span class=n>a</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=mf>1.0</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>,</span> <span class=mf>2.0</span><span class=p>,</span> <span class=mf>2.0</span><span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=kt>double</span> <span class=n>b</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=mf>3.0</span><span class=p>,</span> <span class=mf>3.0</span><span class=p>,</span> <span class=mf>4.0</span><span class=p>,</span> <span class=mf>4.0</span><span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=kt>double</span> <span class=n>hsum</span><span class=p>[</span><span class=mi>4</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>__m256d</span> <span class=n>va</span> <span class=o>=</span> <span class=n>_mm256_loadu_pd</span><span class=p>(</span><span class=n>a</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>__m256d</span> <span class=n>vb</span> <span class=o>=</span> <span class=n>_mm256_loadu_pd</span><span class=p>(</span><span class=n>b</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>__m256d</span> <span class=n>vhsum</span> <span class=o>=</span> <span class=n>_mm256_hadd_pd</span><span class=p>(</span><span class=n>va</span><span class=p>,</span> <span class=n>vb</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>_mm256_storeu_pd</span><span class=p>(</span><span class=n>hsum</span><span class=p>,</span> <span class=n>vhsum</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>std</span><span class=o>::</span><span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>hsum</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=sc>&#39; &#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>std</span><span class=o>::</span><span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>The result of the above code is</p><blockquote><p>2 6 4 8</p></blockquote><h3 id=compare>Compare</h3><p><code>__m256d _mm256_cmp_pd (__m256d a, __m256d b, const int imm8)</code></p><p>According to the third parameter to compare the data from first and second vector, and output the result to a <code>__m256d</code> vector.</p><p>The third parameter value and its corresponding meaning are shown in the table below.</p><table><thead><tr><th>imm8[4:0]</th><th>操作符</th><th>含义</th></tr></thead><tbody><tr><td>0</td><td>_CMP_EQ_OQ</td><td>比较两个操作数是否相等（Ordered, Quiet）</td></tr><tr><td>1</td><td>_CMP_LT_OS</td><td>比较第一个操作数是否小于第二个操作数（Ordered, Signaling）</td></tr><tr><td>2</td><td>_CMP_LE_OS</td><td>比较第一个操作数是否小于等于第二个操作数（Ordered, Signaling）</td></tr><tr><td>3</td><td>_CMP_UNORD_Q</td><td>比较两个操作数是否未排序（Unordered, Quiet）</td></tr><tr><td>4</td><td>_CMP_NEQ_UQ</td><td>比较两个操作数是否不相等（Unordered, Quiet）</td></tr><tr><td>5</td><td>_CMP_NLT_US</td><td>比较第一个操作数是否不小于第二个操作数（Unordered, Signaling）</td></tr><tr><td>6</td><td>_CMP_NLE_US</td><td>比较第一个操作数是否不小于等于第二个操作数（Unordered, Signaling）</td></tr><tr><td>7</td><td>_CMP_ORD_Q</td><td>比较两个操作数是否有序（Ordered, Quiet）</td></tr><tr><td>8</td><td>_CMP_EQ_UQ</td><td>比较两个操作数是否相等（Unordered, Quiet）</td></tr><tr><td>9</td><td>_CMP_NGE_US</td><td>比较第一个操作数是否不大于等于第二个操作数（Unordered, Signaling）</td></tr><tr><td>10</td><td>_CMP_NGT_US</td><td>比较第一个操作数是否不大于第二个操作数（Unordered, Signaling）</td></tr><tr><td>11</td><td>_CMP_FALSE_OQ</td><td>始终返回假（Ordered, Quiet）</td></tr><tr><td>12</td><td>_CMP_NEQ_OQ</td><td>比较两个操作数是否不相等（Ordered, Quiet）</td></tr><tr><td>13</td><td>_CMP_GE_OS</td><td>比较第一个操作数是否大于等于第二个操作数（Ordered, Signaling）</td></tr><tr><td>14</td><td>_CMP_GT_OS</td><td>比较第一个操作数是否大于第二个操作数（Ordered, Signaling）</td></tr><tr><td>15</td><td>_CMP_TRUE_UQ</td><td>始终返回真（Unordered, Quiet）</td></tr><tr><td>16</td><td>_CMP_EQ_OS</td><td>比较两个操作数是否相等（Ordered, Signaling）</td></tr><tr><td>17</td><td>_CMP_LT_OQ</td><td>比较第一个操作数是否小于第二个操作数（Ordered, Quiet）</td></tr><tr><td>18</td><td>_CMP_LE_OQ</td><td>比较第一个操作数是否小于等于第二个操作数（Ordered, Quiet）</td></tr><tr><td>19</td><td>_CMP_UNORD_S</td><td>比较两个操作数是否未排序（Unordered, Signaling）</td></tr><tr><td>20</td><td>_CMP_NEQ_US</td><td>比较两个操作数是否不相等（Unordered, Signaling）</td></tr><tr><td>21</td><td>_CMP_NLT_UQ</td><td>比较第一个操作数是否不小于第二个操作数（Unordered, Quiet）</td></tr><tr><td>22</td><td>_CMP_NLE_UQ</td><td>比较第一个操作数是否不小于等于第二个操作数（Unordered, Quiet）</td></tr><tr><td>23</td><td>_CMP_ORD_S</td><td>比较两个操作数是否有序（Ordered, Signaling）</td></tr><tr><td>24</td><td>_CMP_EQ_US</td><td>比较两个操作数是否相等（Unordered, Signaling）</td></tr><tr><td>25</td><td>_CMP_NGE_UQ</td><td>比较第一个操作数是否不大于等于第二个操作数（Unordered, Quiet）</td></tr><tr><td>26</td><td>_CMP_NGT_UQ</td><td>比较第一个操作数是否不大于第二个操作数（Unordered, Quiet）</td></tr><tr><td>27</td><td>_CMP_FALSE_OS</td><td>始终返回假（Ordered, Signaling）</td></tr><tr><td>28</td><td>_CMP_NEQ_OS</td><td>比较两个操作数是否不相等（Ordered, Signaling）</td></tr><tr><td>29</td><td>_CMP_GE_OQ</td><td>比较第一个操作数是否大于等于第二个操作数（Ordered, Quiet）</td></tr><tr><td>30</td><td>_CMP_GT_OQ</td><td>比较第一个操作数是否大于第二个操作数（Ordered, Quiet）</td></tr><tr><td>31</td><td>_CMP_TRUE_US</td><td>始终返回真（Unordered, Signaling）</td></tr></tbody></table><h3 id=set>set</h3><p><code>__m256d _mm256_set_pd (double e3, double e2, double e1, double e0)</code></p><p>This funciont doesn&rsquo;t have any special effect, it just set value for a vector register. What we need to pay attention to is that the order of the parameters of this function.</p><p>The order of this function follow the real store order of machine, i.e. little-endian（小端序，低有效字节存储在低位，最右侧的位置就是低有效字节以及低位，所以所这种布局遵循了机器的小端序）</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://stackoverflow.com/questions/11228855/header-files-for-x86-simd-intrinsics target=_blank rel="external nofollow noopener noreferrer">Header files for x86 SIMD intrinsics</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2024-06-03 23:45:27">更新于 2024-06-03&nbsp;</span></div></div><div class=post-info-line><div class=post-info-md><span><a href=https://github.com/gaohongy/blog/edit/main/content/posts/HPC/SIMD-Extension.md title=编辑此页 target=_blank rel="external nofollow noopener noreferrer" class=link-to-edit>编辑此页</a></span></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/blog/>主页</a></span></section></div><div class=post-nav><a href=/blog/posts/hpc/openmp/ class=post-nav-item rel=prev title=OpenMP><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>OpenMP</a></div></div></article></main></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div></div><div id=mask></div><div class=reading-progress-bar style=left:0;top:0></div><noscript><div class=noscript-warning>FixIt 主题在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/blog/lib/lightgallery/css/lightgallery-bundle.min.css><link rel=stylesheet href=/blog/lib/katex/katex.min.css><link rel=stylesheet href=/blog/lib/cookieconsent/cookieconsent.min.css><script src=/blog/lib/autocomplete/autocomplete.min.js defer></script><script src=/blog/lib/fuse/fuse.min.js defer></script><script src=/blog/lib/twemoji/twemoji.min.js defer></script><script src=/blog/lib/lightgallery/lightgallery.min.js defer></script><script src=/blog/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js defer></script><script src=/blog/lib/lightgallery/plugins/zoom/lg-zoom.min.js defer></script><script src=/blog/lib/katex/katex.min.js defer></script><script src=/blog/lib/katex/auto-render.min.js defer></script><script src=/blog/lib/katex/copy-tex.min.js defer></script><script src=/blog/lib/katex/mhchem.min.js defer></script><script src=/blog/lib/cookieconsent/cookieconsent.min.js defer></script><script>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:10},comment:{enable:!1},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验。"},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},lightgallery:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{distance:100,findAllMatches:!1,fuseIndexURL:"/blog/index.json",highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!1,isCaseSensitive:!1,location:0,maxResultLength:20,minMatchCharLength:2,noResultsFound:"没有找到结果",snippetLength:50,threshold:.3,type:"fuse",useExtendedSearch:!1},twemoji:!0}</script><script src=/blog/js/theme.min.js defer></script></body></html>